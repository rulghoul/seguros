{% extends 'base.html' %}
{% load getattributes %}
{% block title %}
  {{ titulo }}
{% endblock %}

{% block content %}
  <div class="row" style="margin-bottom: 1em; margin-top: 1em;">
    <h3 class="col-5">{{ titulo }}</h3>
    <input class="form-control col-4 ml-auto" id="myInput" type="text" placeholder="Buscar.." />
  </div>
  <form method="post" action="{% url redirige %}">
    <table class="table table-striped table-sm">
      <thead class="thead-dark">
        <tr>
          {% for encabezado in encabezados %}
            <th>{{ encabezado }}</th>
          {% endfor %}  
          <th></th>
        </tr>
      </thead>
      <tbody id="CuerpoCatalogo">
        {% if not form.instance.id %}
          <tr>
            {% include 'catalogos/save.html' %}
          </tr>
        {% endif %}
        {% for elemento in lista %}
          <tr>
            {% if form.instance.id == elemento.id %}
              {% include 'catalogos/save.html' %}
            {% else %}
              {% for campo in campos %}
                  <td>{{ elemento|getattribute:campo }}</td>
              {% endfor %}
              <td class="text-center">
                <!-- Actualizar -->
                <button formnovalidate class="btn btn-success" 
                name="edit" value="{{ elemento.pk }}">
                <span class="fa fa-pencil"></span>
                </button>
              </td>
            {% endif %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </form>
  <script>
    $(document).ready(function () {
      $('#myInput').on('keyup', function () {
        var value = $(this).val().toLowerCase()
        $('#CuerpoCatalogo tr').filter(function () {
          $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        })
      })
    })
  </script>
{% endblock %}
