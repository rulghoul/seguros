<!DOCTYPE html>
{% extends 'base.html' %} 
{% load crispy_forms_tags %} 
{% block content %}

<div class="row" style="margin-bottom: 1em; margin-top: 1em;">
    <h3 class="col-5">{{ titulo }}</h3>
    <a class="btn btn-secondary col-2" href="{% url add %}">{{ add_label }}</a>
    <input class="form-control col-4 ml-auto" id="myInput" type="text" placeholder="Buscar..">
</div>

<table class="table table-striped table-sm">
    <thead class="thead-dark">
        <tr>
            <th>Cliente</th>
            <th>Telefono</th>
            <th>Aseguradora</th>
            <th>Plan</th>
            <th>Forma de Pago</th>
            <th>Fecha de Pago</th>
            <th>Emision de Poliza</th>
            <th>Estatus</th>
            {% if user.is_staff %}
            <th>Asesor</th>
            {% endif %}
        </tr>
    </thead>
    <tbody id="CuerpoCatalogo">
        {% for poliza in polizas %}
        <tr>
            <td>{{ poliza.persona_principal.nombre }} {{ poliza.persona_principal.primer_apellido }} {{ poliza.persona_principal.segundo_apellido }}</td>
            <td>{{ poliza.persona_principal.telefono }}</td>
            <td>{{ poliza.empresa }}</td>
            <td>{{ poliza.plan }}</td>
            <td>{{ poliza.forma_pago }}</td>
            <td>{{ poliza.fecha_pago }}</td>
            <td>{{ poliza.fecha_emision }}</td>
            <td>{{ poliza.estatus }}</td>
            {% if user.is_staff %}
            <td>{{ poliza.asesor_poliza.usuario.first_name }} {{ poliza.asesor_poliza.usuario.last_name }}</td>
            {% endif %}
        </tr>
        {% endfor %}
    </tbody>
</table>

<script>
    $(document).ready(function(){
      $("#myInput").on("keyup", function() {
        var value = $(this).val().toLowerCase();
        $("#CuerpoCatalogo tr").filter(function() {
          $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        });
      });
    });
  </script>
{% endblock %}
